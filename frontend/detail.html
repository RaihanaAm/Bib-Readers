<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>BibReaders ¬∑ D√©tail</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-50 text-slate-900">
  <header class="px-6 py-4 bg-white shadow">
    <div class="max-w-4xl mx-auto flex items-center justify-between">
      <a href="/" class="text-xl font-bold">üìö BibReaders</a>
      <a href="/reco" class="text-sm hover:underline">Recommandations</a>
    </div>
  </header>

  <main class="max-w-4xl mx-auto p-6">
    <div id="box" class="bg-white rounded-2xl shadow p-4 grid md:grid-cols-3 gap-4">
      <div><img id="img" class="w-full rounded-xl object-cover h-80" /></div>
      <div class="md:col-span-2 space-y-3">
        <h1 id="title" class="text-2xl font-bold"></h1>
        <div class="text-sm text-slate-600" id="author"></div>
        <div class="text-sm">‚≠ê <span id="rating"></span> ¬∑ <span id="price"></span>¬£</div>
        <p id="desc" class="text-sm leading-6 whitespace-pre-line"></p>
      </div>
    </div>
  </main>

  <script>
    const params = new URLSearchParams(location.search);
    const id = params.get('id');
    const API = (path) => `${location.origin}${path}`;

    async function loadDetail() {
      if(!id) { document.getElementById('box').textContent = "ID manquant"; return; }
      const res = await fetch(API(`/api/livres/${id}`));
      if(!res.ok) { document.getElementById('box').textContent = "Livre non trouv√©"; return; }
      const b = await res.json();
      document.getElementById('img').src = b.image_url || '';
      document.getElementById('title').textContent = b.title || '';
      document.getElementById('author').textContent = b.author || '‚Äî';
      document.getElementById('rating').textContent = b.rating ?? 0;
      document.getElementById('price').textContent =
        typeof b.price === 'number' ? b.price.toFixed(2) : (b.price || '');
      document.getElementById('desc').textContent = b.description || '';
    }
    loadDetail();
  </script>
</body>
</html>
